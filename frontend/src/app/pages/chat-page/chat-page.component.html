<main class="chat-container">
    <header class="chat-header" role="banner">
        <h1>AgentTrace Â· Chat</h1>
    </header>

    <section class="chat-input" role="form">
        <mat-form-field class="form-input">
            <textarea #inputArea matInput [(ngModel)]="input" placeholder="Type a messageâ€¦" cdkTextareaAutosize
                [disabled]="loading" (keydown.enter)="onEnter($event)">
            </textarea>
        </mat-form-field>

        <button mat-raised-button (click)="send()" [disabled]="loading || !input.trim()">Send</button>
    </section>

    <section class="chat-section" role="region" aria-label="Chat messages">
        <mat-card>
            <mat-card-content>
                <mat-list>
                    <mat-list-item *ngFor="let m of messages">
                        <article class="bubble" [class.me]="m.role === 'user'" role="listitem">
                            <header *ngIf="m.role !== 'user'" class="bubble-header">
                                <span class="robot-avatar" aria-hidden="true">ðŸ¤–</span>
                                <h3 class="sr-only">Agent</h3>
                            </header>

                            <p class="message-text">{{ m.text }}</p>

                            <footer *ngIf="m.meta?.toolTraces" class="tool-traces" aria-label="Tool traces">
                                <ul>
                                    <li *ngFor="let t of m.meta?.toolTraces">
                                        <small>â€¢ {{ t.name }} ({{ t.durationMs }} ms)</small>
                                    </li>
                                </ul>
                            </footer>
                        </article>
                    </mat-list-item>
                </mat-list>
            </mat-card-content>
        </mat-card>
    </section>

    <app-footer></app-footer>
</main>